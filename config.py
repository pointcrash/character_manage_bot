import os
from dotenv import load_dotenv
from aiogram.fsm.state import State, StatesGroup

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
BOT_TOKEN = os.getenv("TELEGRAM_BOT_TOKEN")

# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
class CharacterCreation(StatesGroup):
    waiting_for_name = State()
    waiting_for_race = State()
    waiting_for_class = State()
    waiting_for_level = State()
    waiting_for_abilities = State()

# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏
class CharacterManagement(StatesGroup):
    waiting_for_character_select = State()
    waiting_for_delete_confirmation = State()
    waiting_for_delete_answer = State()
    waiting_for_proficiencies_character = State()
    waiting_for_proficiencies_list = State()
    waiting_for_expertise_character = State()
    waiting_for_expertise_list = State()
    waiting_for_saving_throws_character = State()
    waiting_for_saving_throws_list = State()

# –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–∞—Å—ã –∏ –∫–ª–∞—Å—Å—ã
RACES = [
    "–ß–µ–ª–æ–≤–µ–∫", "–≠–ª—å—Ñ", "–î–≤–∞—Ä—Ñ", "–ü–æ–ª—É—Ä–æ—Å–ª–∏–∫", "–ü–æ–ª—É—ç–ª—å—Ñ", 
    "–ü–æ–ª—É–æ—Ä–∫", "–¢–∏—Ñ–ª–∏–Ω–≥", "–ì–Ω–æ–º", "–î—Ä–∞–∫–æ–Ω–æ—Ä–æ–∂–¥–µ–Ω–Ω—ã–π"
]

CLASSES = [
    "–í–∞—Ä–≤–∞—Ä", "–ë–∞—Ä–¥", "–ñ—Ä–µ—Ü", "–î—Ä—É–∏–¥", "–í–æ–∏–Ω", 
    "–ú–æ–Ω–∞—Ö", "–ü–∞–ª–∞–¥–∏–Ω", "–°–ª–µ–¥–æ–ø—ã—Ç", "–ü–ª—É—Ç", 
    "–ß–∞—Ä–æ–¥–µ–π", "–ö–æ–ª–¥—É–Ω", "–í–æ–ª—à–µ–±–Ω–∏–∫"
]

# –°–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–∞
MESSAGES = {
    "start": (
        "–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏ D&D 5e. "
        "–Ø –ø–æ–º–æ–≥—É —Ç–µ–±–µ —Å–æ–∑–¥–∞—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º.\n\n"
        "–ò—Å–ø–æ–ª—å–∑—É–π /help —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, —á—Ç–æ —è —É–º–µ—é!"
    ),
    "help": (
        "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n"
        "/start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "/help - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ\n"
        "/create_character - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞\n"
        "/list_characters - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π\n"
        "/view_character - –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ\n"
        "/delete_character - –£–¥–∞–ª–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"
    ),
    "character_creation": {
        "start": "–î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞! –ö–∞–∫ –µ–≥–æ –∑–æ–≤—É—Ç?",
        "name_invalid": "–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—Ç 2 –¥–æ 30 —Å–∏–º–≤–æ–ª–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑:",
        "race": "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—Å—É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:",
        "class": "–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:",
        "level": "–£–∫–∞–∂–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (–æ—Ç 1 –¥–æ 20):",
        "level_invalid": "–£—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º –æ—Ç 1 –¥–æ 20. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑:",
        "abilities": (
            "–¢–µ–ø–µ—Ä—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.\n"
            "–í–≤–µ–¥–∏—Ç–µ 6 —á–∏—Å–µ–ª —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª (–æ—Ç 3 –¥–æ 18).\n"
            "–ü–æ—Ä—è–¥–æ–∫: –°–∏–ª–∞, –õ–æ–≤–∫–æ—Å—Ç—å, –¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ, –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç, –ú—É–¥—Ä–æ—Å—Ç—å, –•–∞—Ä–∏–∑–º–∞\n"
            "–ù–∞–ø—Ä–∏–º–µ—Ä: 15 14 13 12 10 8"
        ),
        "abilities_invalid": (
            "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ 6 —á–∏—Å–µ–ª –æ—Ç 3 –¥–æ 18 —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª.\n"
            "–ü–æ—Ä—è–¥–æ–∫: –°–∏–ª–∞, –õ–æ–≤–∫–æ—Å—Ç—å, –¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ, –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç, –ú—É–¥—Ä–æ—Å—Ç—å, –•–∞—Ä–∏–∑–º–∞"
        ),
        "success": "–û—Ç–ª–∏—á–Ω–æ! –ü–µ—Ä—Å–æ–Ω–∞–∂ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥."
    },
    "character_management": {
        "no_characters": "–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /create_character —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞!",
        "list_characters": "–í–∞—à–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏:\n\n{characters_list}",
        "select_character": "–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:",
        "character_info": (
            "üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ:\n\n"
            "üë§ –ò–º—è: {name}\n"
            "üèÉ –†–∞—Å–∞: {race}\n"
            "‚öîÔ∏è –ö–ª–∞—Å—Å: {class_name}\n"
            "üìä –£—Ä–æ–≤–µ–Ω—å: {level}\n\n"
            "üìà –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:\n"
            "üí™ –°–∏–ª–∞: {strength} ({strength_mod:+d})\n"
            "üéØ –õ–æ–≤–∫–æ—Å—Ç—å: {dexterity} ({dexterity_mod:+d})\n"
            "‚ù§Ô∏è –¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ: {constitution} ({constitution_mod:+d})\n"
            "üß† –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: {intelligence} ({intelligence_mod:+d})\n"
            "üëÅÔ∏è –ú—É–¥—Ä–æ—Å—Ç—å: {wisdom} ({wisdom_mod:+d})\n"
            "‚ú® –•–∞—Ä–∏–∑–º–∞: {charisma} ({charisma_mod:+d})"
        ),
        "delete_confirmation": "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ {name}? (–¥–∞/–Ω–µ—Ç)",
        "delete_success": "–ü–µ—Ä—Å–æ–Ω–∞–∂ {name} —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω.",
        "delete_cancelled": "–£–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –æ—Ç–º–µ–Ω–µ–Ω–æ."
    },
    "common": {
        "invalid_input": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞.",
        "error": "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."
    }
} 